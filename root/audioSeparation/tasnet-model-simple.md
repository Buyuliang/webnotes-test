# tasnet-model-simple

# TasNet ç®€æ˜ç¤ºä¾‹ä¸è¯´æ˜

## ğŸ¯ ä¸€ã€é—®é¢˜æœ¬è´¨
æˆ‘ä»¬æœ‰ä¸€ä¸ªæ··åˆä¿¡å·ï¼š

$$
x = [1, 2, 3, 4]
$$

å®ƒç”±ä¸¤ä¸ªäººå åŠ è€Œæˆï¼š

$$
s_A = [0, 1, 0, 3]
$$

$$
s_B = [1, 1, 3, 1]
$$

éªŒè¯ä¸€ä¸‹ï¼š

```text
A: 0 1 0 3
B: 1 1 3 1
--------------
x: 1 2 3 4
```

âœ… ç¡®å®æ˜¯ç›¸åŠ å¾—åˆ°ã€‚

---

## ğŸ¯ äºŒã€TasNet åœ¨åšä»€ä¹ˆï¼Ÿ
ä¸€å¥è¯è§£é‡Šï¼š

å®ƒä¸ç›´æ¥åœ¨åŸå§‹æ³¢å½¢ä¸Šåˆ†ç¦»
è€Œæ˜¯å…ˆå˜æ¢åˆ°ä¸€ä¸ªâ€œç¼–ç ç©ºé—´â€
ç„¶ååœ¨ç¼–ç ç©ºé—´é‡Œåšæ‹†åˆ†

å°±åƒï¼š

åŸå§‹å£°éŸ³ = åŸææ–™
ç¼–ç ç©ºé—´ = ä¹é«˜ç§¯æœ¨
åˆ†ç¦» = æŠŠç§¯æœ¨åˆ†æˆä¸¤å †
è§£ç  = å†æ‹¼å›ä¸¤ä¸ªå£°éŸ³


---

## ğŸ¯ ä¸‰ã€ç¬¬ä¸€æ­¥ï¼šEncoderï¼ˆç¼–ç ï¼‰
å‚æ•°ï¼š

- kernel size = 2
- stride = 1
- filter = [1,0]

âœ… å«ä¹‰è§£é‡Š
æˆ‘ä»¬æ‹¿ä¸€ä¸ªå°çª—å£åœ¨ä¿¡å·ä¸Šæ»‘åŠ¨ã€‚å°±åƒï¼š

```text
çª—å£1: [1,2]
çª—å£2: [2,3]
çª—å£3: [3,4]
```

filter = [1,0] æ„å‘³ç€ï¼šåªå–çª—å£ç¬¬ä¸€ä¸ªæ•°ã€‚

âœ… è®¡ç®—

```text
[1,2] â†’ 1
[2,3] â†’ 2
[3,4] â†’ 3
```

å¾—åˆ°ç¼–ç ï¼š

$$
E = [1, 2, 3]
$$

âœ… é€šä¿—ç†è§£
è¿™ä¸€æ­¥æ˜¯åœ¨æŠŠæ—¶é—´ä¿¡å·å˜æˆâ€œç‰¹å¾è¡¨ç¤ºâ€ã€‚

ä½†è¿™ä¸ªç®€åŒ–ä¾‹å­ä¸¢å¤±äº†ä¸€éƒ¨åˆ†ä¿¡æ¯ï¼ˆçœŸå® TasNet ä¸ä¼šï¼‰ã€‚

---

## ğŸ¯ å››ã€ç†æƒ³æƒ…å†µä¸‹ A å’Œ B çš„ç¼–ç 
æˆ‘ä»¬å¯¹ A å’Œ B åˆ†åˆ«åšåŒæ ·æ“ä½œã€‚

âœ… A çš„ç¼–ç 
A = [0,1,0,3]
çª—å£ï¼š

```text
[0,1] â†’ 0
[1,0] â†’ 1
[0,3] â†’ 0
```

$$
E_A = [0,1,0]
$$

âœ… B çš„ç¼–ç 
B = [1,1,3,1]
çª—å£ï¼š

```text
[1,1] â†’ 1
[1,3] â†’ 1
[3,1] â†’ 3
```

$$
E_B = [1,1,3]
$$

âœ… éªŒè¯

$$
E_A + E_B = [0+1, 1+1, 0+3] = [1,2,3]
$$

âœ… ç­‰äº E

---

## ğŸ¯ äº”ã€Mask çš„å«ä¹‰
TasNet ä¸ç›´æ¥é¢„æµ‹ A å’Œ Bã€‚å®ƒé¢„æµ‹çš„æ˜¯æ¯ä¸ªæ—¶é—´ä½ç½®å±äºè°çš„æ¯”ä¾‹ã€‚

å…¬å¼ï¼š

$$
M_A = E_A / E
$$

$$
M_B = E_B / E
$$

âœ… è®¡ç®—

A çš„ maskï¼š

$$
[0/1, 1/2, 0/3] = [0, 0.5, 0]
$$

B çš„ maskï¼š

$$
[1/1, 1/2, 3/3] = [1, 0.5, 1]
$$

âœ… é€šä¿—è§£é‡Š
ä¾‹å¦‚åœ¨ç¬¬äºŒä¸ªä½ç½®ï¼šæ··åˆå€¼ = 2ï¼ŒA å  1ï¼ŒB å  1ï¼Œæ‰€ä»¥ A å  50%ï¼ŒB å  50%ã€‚

---

## ğŸ¯ å…­ã€åº”ç”¨ Mask

$$
\hat{E}_A = M_A \times E
$$

$$
= [0\times1, 0.5\times2, 0\times3]
= [0,1,0]
$$

âœ… æ¢å¤ E_A

$$
\hat{E}_B = [1\times1, 0.5\times2, 1\times3]
= [1,1,3]
$$

âœ… æ¢å¤ E_B

---

## ğŸ¯ ä¸ƒã€Decoderï¼ˆè§£ç ï¼‰
Decoder filter = [1,0]
æ¯ä¸ªç¼–ç å€¼ç”Ÿæˆä¸€å¸§ã€‚

âœ… é‡å»º A
E_A = [0,1,0]
ç”Ÿæˆå¸§ï¼š

```text
0 â†’ [0,0]
1 â†’ [1,0]
0 â†’ [0,0]
```

Overlap-addï¼š

åˆå§‹åŒ–ï¼š

```text
[0,0,0,0]
```

åŠ å…¥å¸§ï¼š

```text
frame1 â†’ [0,0,0,0]
frame2 â†’ [0,1,0,0]
frame3 â†’ [0,1,0,0]
```

å¾—åˆ°ï¼š

$$
\hat{s}_A = [0,1,0,0]
$$

âœ… é‡å»º B
E_B = [1,1,3]
ç”Ÿæˆå¸§ï¼š

```text
1 â†’ [1,0]
1 â†’ [1,0]
3 â†’ [3,0]
```

Overlap-addï¼š

```text
frame1 â†’ [1,0,0,0]
frame2 â†’ [1,1,0,0]
frame3 â†’ [1,1,3,0]
```

å¾—åˆ°ï¼š

$$
\hat{s}_B = [1,1,3,0]
$$

---

## ğŸ¯ å…«ã€ä¸ºä»€ä¹ˆæœ€åä¸€ä½é”™äº†ï¼Ÿ
å› ä¸º filter = [1,0] åªå–äº†çª—å£ç¬¬ä¸€ä¸ªæ•°ï¼Œä¿¡æ¯ä¸¢å¤±å¯¼è‡´æ— æ³•æ­£ç¡®è¿˜åŸæœ«ä½ã€‚

---

## ğŸ¯ ä¹ã€çœŸå® TasNet æ˜¯æ€æ ·çš„ï¼Ÿ
çœŸå®æ¨¡å‹ï¼š
- âœ… å¤šä¸ª filterï¼ˆä¸æ˜¯ä¸€ä¸ªï¼‰
- âœ… å¯å­¦ä¹ 
- âœ… å½¢æˆå®Œæ•´è¡¨ç¤º
- âœ… decoder èƒ½å®Œç¾é‡å»º

ä¿è¯ï¼š

$$
Decoder(Encoder(x)) \approx x
$$

---

## ğŸ¯ åã€æ•´ä¸ªæµç¨‹çš„ç›´è§‚ç†è§£

```text
æ··åˆå£°éŸ³
   â†“
åˆ‡æˆå°å—ï¼ˆencoderï¼‰
   â†“
å˜æˆç‰¹å¾
   â†“
åˆ¤æ–­æ¯å—å±äºè°ï¼ˆmaskï¼‰
   â†“
åˆ†æˆä¸¤ä»½ç‰¹å¾
   â†“
æ‹¼å›æ—¶é—´æ³¢å½¢ï¼ˆdecoderï¼‰
```

---

## ğŸ¯ åä¸€ã€æ ¸å¿ƒæ€æƒ³æ€»ç»“
TasNet çš„æ ¸å¿ƒæ˜¯ï¼šåœ¨ä¸€ä¸ªçº¿æ€§ç©ºé—´é‡ŒåšåŠ æ³•åˆ†è§£ã€‚

å› ä¸ºï¼š

$$
x = A + B$$
åœ¨ç¼–ç ç©ºé—´ï¼š
$$
E = E_A + E_B
$$

åªè¦ç©ºé—´æ˜¯çº¿æ€§çš„ï¼Œåˆ†å¼€å†è§£ç å°±å¯ä»¥ã€‚

âœ… ä¸€å¥è¯æ€»ç»“ï¼šTasNet æœ¬è´¨ä¸Šæ˜¯åœ¨å›ç­”â€œæ¯ä¸ªæ—¶é—´å±€éƒ¨çš„èƒ½é‡ï¼Œåº”è¯¥åˆ†ç»™è°ï¼Ÿâ€



#




# TasNet çŸ©é˜µå½¢å¼è¯´æ˜

## âœ… ä¸€ã€é—®é¢˜è®¾å®š
æ··åˆä¿¡å·ï¼š

$$
x =
\begin{bmatrix}
1\\
2\\
3\\
4
\end{bmatrix}
$$

çœŸå®ä¿¡å·ï¼š

$$
s_A =
\begin{bmatrix}
0\\
1\\
0\\
3
\end{bmatrix}
$$

$$
s_B =
\begin{bmatrix}
1\\
1\\
3\\
1
\end{bmatrix}
$$

æ»¡è¶³ï¼š

$$
x = s_A + s_B$$

---

## âœ… äºŒã€Encoder å†™æˆçŸ©é˜µ
å‚æ•°ç¤ºä¾‹ï¼ˆç®€åŒ–ï¼‰ï¼š
- kernel size = 2
- stride = 1
- filter = [1, 0]

æ»‘åŠ¨çª—å£æ“ä½œç­‰ä»·äºä¸€ä¸ªçº¿æ€§å˜æ¢çŸ©é˜µã€‚

ç¼–ç çŸ©é˜µ $W$ï¼ˆæœ¬ä¾‹ä¸­å–çª—å£é¦–å…ƒç´ ï¼‰ï¼š

$$
W =
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0
\end{bmatrix}
$$

ç¼–ç æ“ä½œï¼š

$$
E = W x
$$

ä»£å…¥è®¡ç®—ï¼š

$$
W x =
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0
\end{bmatrix}
\begin{bmatrix}
1\\
2\\
3\\
4
\end{bmatrix}
=
\begin{bmatrix}
1\\
2\\
3
\end{bmatrix}
$$

ä¸å‰é¢ç®€åŒ–çš„æ»‘åŠ¨çª—å£ç»“æœä¸€è‡´ã€‚

---

## âœ… ä¸‰ã€ç¼–ç ç©ºé—´ä¸­çš„åŠ æ³•æ€§è´¨
å› ä¸º $W$ æ˜¯çº¿æ€§å˜æ¢ï¼š

$$
W(x) = W(s_A + s_B) = W s_A + W s_B
$$

è®¡ç®—ï¼š

$$
E_A = W s_A =
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0
\end{bmatrix}
\begin{bmatrix}
0\\
1\\
0\\
3
\end{bmatrix}
= \begin{bmatrix}0\\1\\0\end{bmatrix}
$$

$$
E_B = W s_B = \begin{bmatrix}1\\1\\3\end{bmatrix}
$$

å› æ­¤æ»¡è¶³ï¼š

$$
E = E_A + E_B
$$

---

## âœ… å››ã€Mask å†™æˆå¯¹è§’çŸ©é˜µ
ä¹‹å‰ç®—å‡ºçš„ maskï¼š

$$
M_A = [0,\; 0.5,\; 0]
$$

å°†å…¶å†™æˆå¯¹è§’çŸ©é˜µï¼š

$$
D_A =
\begin{bmatrix}
0 & 0 & 0 \\
0 & 0.5 & 0 \\
0 & 0 & 0
\end{bmatrix}
$$

åŒæ ·ï¼š

$$
D_B =
\begin{bmatrix}
1 & 0 & 0 \\
0 & 0.5 & 0 \\
0 & 0 & 1
\end{bmatrix}
$$

---

## âœ… äº”ã€Mask åˆ†ç¦»è¿‡ç¨‹
åˆ†ç¦»å…¬å¼ï¼š

$$
\hat{E}_A = D_A E
$$

ä»£å…¥å¾—åˆ°ï¼š

$$
\hat{E}_A =
\begin{bmatrix}
0 & 0 & 0 \\
0 & 0.5 & 0 \\
0 & 0 & 0
\end{bmatrix}
\begin{bmatrix}
1\\
2\\
3
\end{bmatrix}
= \begin{bmatrix}0\\1\\0\end{bmatrix}
$$

åŒç†ï¼š

$$
\hat{E}_B = D_B E = \begin{bmatrix}1\\1\\3\end{bmatrix}
$$

---

## âœ… å…­ã€Decoder å†™æˆçŸ©é˜µ
Decoder å¯¹åº” overlap-add çš„çº¿æ€§è¿‡ç¨‹ã€‚åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼ŒDecoder å¯è¡¨ç¤ºä¸º $W^T$ï¼Œå› ä¸º Encoder åªæ˜¯æˆªå–å‰ä¸‰ä¸ªå…ƒç´ ã€‚

$$
W^T =
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1 \\
0 & 0 & 0
\end{bmatrix}
$$

é‡å»º Aï¼š

$$
\hat{s}_A = W^T \hat{E}_A =
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1 \\
0 & 0 & 0
\end{bmatrix}
\begin{bmatrix}0\\1\\0\end{bmatrix}
= \begin{bmatrix}0\\1\\0\\0\end{bmatrix}
$$

é‡å»º Bï¼š

$$
\hat{s}_B = W^T \hat{E}_B = \begin{bmatrix}1\\1\\3\\0\end{bmatrix}
$$

---

## âœ… ä¸ƒã€æ•´ä½“å…¬å¼æ€»ç»“
æ•´ä¸ª TasNet è¿‡ç¨‹å¯ä»¥å†™æˆï¼š

ç¼–ç ï¼š
$$E = W x$$

åˆ†ç¦»ï¼ˆmaskï¼‰ï¼š
$$\hat{E}_k = D_k E$$

è§£ç ï¼š
$$\hat{s}_k = W^T \hat{E}_k$$

åˆå¹¶æˆä¸€ä¸ªå…¬å¼ï¼š

$$\hat{s}_k = W^T D_k W x$$

---

## âœ… å…«ã€å…³é”®ç†è§£ï¼ˆéå¸¸é‡è¦ï¼‰
è¯¥ç®—å­æ˜¯ä¸€ä¸ªçº¿æ€§ç®—å­ï¼Œç­‰ä»·äºå¯¹è¾“å…¥åšä¸€æ¬¡ä½ç§©æŠ•å½±ä¸å­ç©ºé—´åˆ†è§£ï¼š

$$\hat{s}_k = W^T D_k W x$$

å¦‚æœ $W^T W = I$ï¼ˆå³ $W$ æ„æˆå®Œå¤‡åŸºï¼‰ï¼Œåˆ™ $W^T W x = x$ï¼Œç³»ç»Ÿå¯å®Œç¾é‡å»ºã€‚

çœŸå® TasNet é€šè¿‡å­¦ä¹ æ›´ä¸°å¯Œã€å¯é€†ï¼ˆæˆ–è¿‘ä¼¼å¯é€†ï¼‰çš„ $W$ï¼Œä»¥åŠè®­ç»ƒå¾—åˆ°çš„ maskï¼Œè¾¾åˆ°é«˜è´¨é‡åˆ†ç¦»ä¸é‡å»ºã€‚

---

## âœ… ä¹ã€ç»ˆæç†è§£
TasNet çš„æœ¬è´¨æ˜¯ï¼šåœ¨ä¸€ä¸ªå­¦ä¹ åˆ°çš„çº¿æ€§å­ç©ºé—´é‡Œï¼Œç”¨å¯¹è§’æ©ç çŸ©é˜µåšæŠ•å½±åˆ†è§£ï¼Œä»è€ŒæŠŠæ··åˆä¿¡å·åœ¨ç¼–ç ç©ºé—´ä¸­æ‹†åˆ†ä¸ºå„è‡ªæˆåˆ†å¹¶è§£ç å›æ—¶åŸŸã€‚